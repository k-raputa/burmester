(window.webpackJsonp=window.webpackJsonp||[]).push([["swag-customized-products"],{"/v9U":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return h}));var o=n("FGIj"),i=n("gHbT");function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c,p,d,h=function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),s(this,l(n).apply(this,arguments))}var o,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(n,e),o=n,(r=[{key:"init",value:function(){this.parentEl=this.el.parentNode,this.exclusionsValid=!0,this._registerEventListeners()}},{key:"_registerEventListeners",value:function(){var t=this;this.$emitter.subscribe("buyButtonDisable",this.updateExclusionValidity.bind(this)),this.$emitter.subscribe("change",this.onFormChange.bind(this)),i.a.querySelectorAll(this.parentEl,this.options.inputFieldsSelector,!1).forEach((function(e){e.addEventListener("invalid",t._onInputInvalid.bind(t))})),this.onFormChange()}},{key:"onFormChange",value:function(){var t=this,e=i.a.querySelector(this.parentEl,this.options.selectors.buyButton),n=i.a.querySelectorAll(this.parentEl,this.options.inputFieldsSelector,!1),o={},r=Array.from(n).reduce((function(e,n){var r=n.dataset.swagCustomizedProductsSelectionRequired;void 0!==r&&(o[r]=o[r]||n.checked,n.hasAttribute("required")&&n.removeAttribute("required"));var a=n.closest(t.options.selectors.fileUploadContainer);if(a){if(!i.a.getDataAttribute(n,"required",!1))return e;var s=window.PluginManager.getPluginInstanceFromElement(a,"SwagCustomizedProductsFileUpload");return void 0!==s&&s.registry.size>0?e:e=!1}return e&&n.required?n.required&&n.value.length?e:e=!1:e}),!0)&&Object.values(o).every((function(t){return t}))&&this.exclusionsValid,a=i.a.querySelector(this.parentEl,this.options.selectors.confirmInput,!1);a&&(r=r&&a.checked),r?e.hasAttribute("disabled")&&e.removeAttribute("disabled"):e.setAttribute("disabled","disabled")}},{key:"_onInputInvalid",value:function(e){var n=e.target.closest(".collapse");t(n).collapse("show"),this.$emitter.publish("invalid",{element:e.target})}},{key:"updateExclusionValidity",value:function(t){this.exclusionsValid=!t.detail,this.onFormChange()}}])&&a(o.prototype,r),c&&a(o,c),n}(o.a);d={inputFieldsSelector:"input, textarea",selectors:{buyButton:"#productDetailPageBuyProductForm .btn-buy",fileUploadContainer:".customized-products-upload",confirmInput:"#swag-customized-products-confirm-input"}},(p="options")in(c=h)?Object.defineProperty(c,p,{value:d,enumerable:!0,configurable:!0,writable:!0}):c[p]=d}).call(this,n("UoTJ"))},BOm7:function(t,e,n){"use strict";n.r(e),e.default={type:["default"],validate:function(t){var e=t.element;return"X"===t.operator?e.value.length>0:!e.value.length}}},Cp0N:function(t,e,n){"use strict";n.r(e),e.default={type:["htmleditor"],validate:function(t){var e=t.element,n=t.operator,o=window.PluginManager.getPluginInstanceFromElement(e,"SwagCustomizedProductsHtmlEditor");return"X"===n?!o.isEmpty():o.isEmpty()}}},"F4Z+":function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return y}));var o=n("FGIj"),i=n("gHbT"),r=n("eg0c");function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function l(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],o=!0,i=!1,r=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(t){i=!0,r=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h,f,m,y=function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),c(this,p(n).apply(this,arguments))}var o,a,h;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(n,e),o=n,h=[{key:"mergeExclusionTreeWithElements",value:function(t,e){return t.length<=0?new Map:t.reduce((function(t,n){var o=null;return n=n.reduce((function(t,n){return null===o&&(o=n.id),n.element=function(t){return e.find((function(e){return e.id===t})).element}(n.id),t.push(n),t}),[]),t.set(o,n),t}),new Map)}},{key:"findLabelForFormElement",value:function(t){return t.closest(".swag-customized-products-option",!1).querySelector(".swag-customized-products-option__title").innerText.trim()}},{key:"updateViolationListDisplay",value:function(t,e,n,o){if(!t||t.length<=0)return e.innerHTML="",!1;var i='\n            <ul class="violation-list">\n                '.concat(t.map((function(t){var e=t.excludedElements.map((function(t){var e=t.element.id;return'<li>\n                        <strong class="entry__link" data-target="'.concat(e,'">\n                            ').concat(t.labelText,"\n                        </strong>\n                    </li>")}));return e='<ul class="excluded-element-list">'.concat(e.join(""),"</ul>"),'<li class="violation-list__entry">'.concat(function(t,e){var o=n.excludeItem.replace("%1",t);return o=o.replace("%2",e)}('<strong class="entry__link" data-target="'.concat(t.element.id,'">').concat(t.labelText,"</strong>"),e),"</li>")})).join(""),"\n            </ul>\n        ");return o=(o=o.replace("%1",n.headline)).replace("%2",i),e.innerHTML=o,!0}}],(a=[{key:"init",value:function(){this.parentEl=this.el.closest("form"),this.isStepByStepActive=i.a.hasAttribute(this.el,"data-swag-customized-product-step-by-step"),this.stepByStepModePlugin=null,this.isStepByStepActive&&(this.stepByStepModePlugin=window.PluginManager.getPluginInstanceFromElement(this.el,"SwagCustomizedProductsStepByStepWizard")),this.violationHolderElement=i.a.querySelector(this.parentEl,".swag-customized-products__violation-list-holder"),this.violationTemplate=this.violationHolderElement.querySelector("div"),this.violationTemplateString=this.violationTemplate.cloneNode(!0).children[0].outerHTML,this.buyButton=i.a.querySelector(document,this.options.buyButtonSelector),this.isViolation=!1,this.violationTemplate.parentNode.removeChild(this.violationTemplate),this.translations={excludeItem:i.a.getDataAttribute(this.el,"swag-exclusion-translation-excludeitem"),headline:i.a.getDataAttribute(this.el,"swag-exclusion-translation-headline")};var t=i.a.getDataAttribute(this.el,"data-swag-exclusion-list-validation-options"),e=this.collectInputElements(this.el,this.options);this.exclusionTree=n.mergeExclusionTreeWithElements(t,e),this.optionTypeManager=Object(r.a)(this.$emitter),this.onInputChange(),this._registerEventListeners()}},{key:"_registerEventListeners",value:function(){this.parentEl.addEventListener("change",this.onInputChange.bind(this),!1),this.violationHolderElement.addEventListener("click",this.onViolationHolderElementClick.bind(this))}},{key:"onViolationHolderElementClick",value:function(e){var n=e.target;if(n.matches(".entry__link")){e.preventDefault();var o=i.a.getDataAttribute(n,"data-target"),r=i.a.querySelector(this.el,"#".concat(o));this.isStepByStepActive&&this.switchPageInStepByStep(r);var a=r.closest(this.options.collapsePanelSelector);a&&!this.isStepByStepActive&&t(a).collapse("show");var s,l=((s=r.getBoundingClientRect()).left,window.scrollX,s.top+window.scrollY);window.scrollTo({top:l-this.options.scrollOffset,left:0,behavior:"smooth"})}}},{key:"switchPageInStepByStep",value:function(t){var e=this.stepByStepModePlugin,n=t.closest(".swag-customized-products__item"),o=e.navigationEntries.find((function(t){return t.pageEl.isSameNode(n)}));return!!o&&(e.transitionToPage.call(e,o.pageNum+1),!0)}},{key:"onInputChange",value:function(){var t=this.buildViolations();this.isViolation=t,t?this.$emitter.publish("buyButtonDisable",!0):this.$emitter.publish("buyButtonDisable",!1)}},{key:"collectInputElements",value:function(t,e){var n=this;return Array.from(i.a.querySelectorAll(t,e.formControlSelector)).map((function(t){return{element:t,id:n.extractIdFromElement(t),defaultValue:t.defaultValue}}))}},{key:"buildViolations",value:function(){var t=this,e=this.exclusionTree,o=Array.from(e).map((function(e){var n=l(e,2)[1];return{violationFound:n.reduce((function(e,n){var o=n.element,i=n.operator,r=n.type;return e?e=t.validateElementState(o,i.type,r):e}),!0),elements:n}}));if(!(o=o.filter((function(t){return!0===t.violationFound})))||o.length<=0)return n.updateViolationListDisplay([],this.violationHolderElement,this.translations,this.violationTemplateString),!1;var i=o.map((function(t){return t.elements})).map((function(t){var e=s(t),o=e.shift(),i=n.findLabelForFormElement(o.element),r=e.map((function(t){return{labelText:n.findLabelForFormElement(t.element),element:t.element}}));return{element:o.element,labelText:i,excludedElements:r}}));return n.updateViolationListDisplay(i,this.violationHolderElement,this.translations,this.violationTemplateString),!0}},{key:"extractIdFromElement",value:function(t){var e=t.id;return e&&e.length?e.replace(this.options.prefixes.optionId,"").replace(this.options.prefixes.uploadElement,""):""}},{key:"validateElementState",value:function(t,e,n){return this.optionTypeManager.call(this,this.optionTypeManager.has(n)?n:"default","validate",{element:t,operator:e,type:n})}}])&&u(o.prototype,a),h&&u(o,h),n}(o.a);m={formControlSelector:".swag-customized-products-form-control",buyButtonSelector:"#productDetailPageBuyProductForm .btn-buy",collapsePanelSelector:".collapse",scrollOffset:80,prefixes:{optionId:"swag-customized-products-option-id-",uploadElement:"customized-products-dropzone-input-"}},(f="options")in(h=y)?Object.defineProperty(h,f,{value:m,enumerable:!0,configurable:!0,writable:!0}):h[f]=m}).call(this,n("UoTJ"))},J6sK:function(t,e,n){"use strict";n.r(e),e.default={type:["datetime","timestamp"],validate:function(t){var e=t.element;return"X"===t.operator?e.value.length>0:!e.value.length}}},Kpce:function(t,e,n){var o={"./exclusion-list-type-checkbox.js":"bEUM","./exclusion-list-type-colorselect.js":"UuB4","./exclusion-list-type-datetime-timestamp.js":"J6sK","./exclusion-list-type-default.js":"BOm7","./exclusion-list-type-htmleditor.js":"Cp0N","./exclusion-list-type-numberfield.js":"Nf7v","./exclusion-list-type-upload.js":"aUfU"};function i(t){var e=r(t);return n(e)}function r(t){if(!n.o(o,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return o[t]}i.keys=function(){return Object.keys(o)},i.resolve=r,t.exports=i,i.id="Kpce"},Nf7v:function(t,e,n){"use strict";n.r(e),e.default={type:["numberfield"],validate:function(t){var e=t.element,n=t.operator,o=e.defaultValue;return"X"===n?e.value!==o:e.value===o}}},PMI4:function(t,e){HTMLFormElement.prototype.reportValidity||(HTMLFormElement.prototype.reportValidity=function(){if(this.checkValidity())return!0;var t=document.createElement("button");return this.appendChild(t),t.click(),this.removeChild(t),!1}),HTMLInputElement.prototype.reportValidity||(HTMLInputElement.prototype.reportValidity=function(){if(this.checkValidity())return!0;var t;this.form||((t=document.createElement("form")).style.display="inline",this.before(t),t.append(this));var e=Array.from(this.form.elements).filter((function(t){return t!==this&&!!t.checkValidity&&!t.disabled}),this);return e.forEach((function(t){t.disabled=!0})),this.form.reportValidity(),e.forEach((function(t){t.disabled=!1})),t&&(t.before(this),t.remove()),this.focus(),this.selectionStart=0,!1})},RVSf:function(t,e,n){"use strict";n.r(e);n("PMI4");var o=n("lxcy"),i=n("/v9U"),r=n("FGIj"),a=n("gHbT"),s=n("nhVY");function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f=["<div><br></div>","<p><br></p>","<br>"],m=function(t){var e=t.tag,n=void 0===e?"div":e,o=t.classes,i=void 0===o?[]:o,r=t.attributes,a=void 0===r?{}:r,s=t.html,l=void 0===s?null:s,u=t.children,c=void 0===u?[]:u,p=t.listeners,d=void 0===p?{}:p,h=t.styles,f=void 0===h?{}:h,m=t.value,y=void 0===m?null:m,g=document.createElement(n);return i.forEach((function(t){g.classList.add(t)})),Object.keys(a).forEach((function(t){var e=a[t];g.setAttribute(t,e)})),Object.keys(f).forEach((function(t){g.style[t]=f[t]})),l&&l.length>0&&(g.innerHTML=l),y&&y.length<0&&(g.value=y),c.forEach((function(t){g.appendChild(t)})),Object.keys(d).forEach((function(t){var e=d[t];g.addEventListener(t,e,!1)})),g},y=function(t){if("function"==typeof Event)return new Event(t);var e=document.createEvent("Event");return e.initEvent(t,!0,!0),e},g=function(){return/Trident/.test(navigator.userAgent)},v=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),c(this,p(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){var t=this.el.value||"";this.translations=a.a.getDataAttribute(this.el,"swag-customized-products-html-editor-translations"),this.iconContainer=a.a.querySelector(document,this.options.iconContainerSelector),this.formValidatorPlugin=window.PluginManager.getPluginInstanceFromElement(a.a.querySelector(document,this.options.customizedProductContainer),"SwagCustomizedProductsFormValidator"),this.buttonConfig=this.hydrateButtonConfig(this.options.buttonConfig),this.iconContainer.parentNode.removeChild(this.iconContainer),delete this.iconContainer,this.toolbar=this.createToolbarElement();var e=this.createEditorElement(t),n=e.editor,o=e.editorWrapper;this.editor=n,this.editorWrapper=o,this.wrapper=this.createWrapperElement(),this.placeholder=this.createPlaceholder(t.length<=0),this.setupTextarea(),this.createPanel()}},{key:"hydrateButtonConfig",value:function(t){var e=this;return t.map((function(t){var n=a.a.querySelector(e.iconContainer,".".concat(t.iconClassName),!1)||null;return t.icon=null,t.label=e.translations[t.action],n&&(t.icon=n.cloneNode(!0)),t}))}},{key:"setupTextarea",value:function(){return this.el.style.display="none",!0}},{key:"createPanel",value:function(){return this.wrapper.appendChild(this.toolbar),this.wrapper.appendChild(this.editorWrapper),this.editorWrapper.appendChild(this.placeholder),this.el.parentNode.appendChild(this.wrapper),!0}},{key:"createToolbarElement",value:function(){var t=this,e=m({classes:[this.getPrefixedClass("toolbar")],attributes:{role:"toolbar","aria-label":this.translations.textFormatting,"aria-controls":this.getEditorElementId()}});return this.buttonConfig.forEach((function(n){e.appendChild(t.createToolbarButtonElement(n))})),e}},{key:"createToolbarButtonElement",value:function(t){var e=this,n=m({tag:"button",classes:[this.getPrefixedClass("toolbar-button"),this.getPrefixedClass("button-".concat(t.action),"toolbar")],attributes:{"aria-pressed":t.pressed,"aria-label":t.label,tabindex:-1},html:t.icon?null:t.label,value:t.label,listeners:{click:function(n){n.preventDefault(),e.onToolbarButtonPressed(t)}}});if(t.icon){var o=t.icon;o.setAttribute("aria-hidden",!0),n.appendChild(o)}return t.button=n,n}},{key:"createWrapperElement",value:function(){return m({classes:[this.options.baseClass]})}},{key:"createEditorElement",value:function(t){var e,n=this,o=g()?"keydown":"input",i=t||"<div><br></div>";g()&&!t.length&&(i="");var r=m({classes:[this.getPrefixedClass("editor")],attributes:{contenteditable:!0,spellcheck:!0,autocorrect:!0,role:"textbox",id:this.getEditorElementId(),"aria-multiline":!0,tabindex:-1},html:i,listeners:(e={keydown:function(t){n.isEmpty()&&8===t.keyCode&&(t.preventDefault(),n.editor.innerHTML="<div><br></div>")}},h(e,o,s.a.debounce(this.onEditorInput.bind(this),350)),h(e,"focus",(function(){n.el.dispatchEvent(y("focus")),n.isEmpty()&&!g()&&(n.editor.innerHTML="<div><br></div>")})),h(e,"blur",(function(){n.el.dispatchEvent(y("blur")),n.isEmpty()&&n.showPlaceholder()})),e)}),a=m({classes:[this.getPrefixedClass("editor-wrapper")]});return a.appendChild(r),{editor:r,editorWrapper:a}}},{key:"createPlaceholder",value:function(t){var e=this,n=this.el.getAttribute("placeholder");return m({classes:[this.getPrefixedClass("placeholder")],styles:{display:t?"block":"none"},listeners:{click:function(){e.hidePlaceholder(),e.editor.focus()}},html:n})}},{key:"getPrefixedClass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.baseClass;return!(!t||!t.length<0)&&"".concat(e,"__").concat(t)}},{key:"getEditorElementId",value:function(){return"".concat(this.el.getAttribute("id"),"-editor")}},{key:"getContent",value:function(){return this.editor.innerHTML}},{key:"getTextContent",value:function(){return this.editor.innerText.trim()}},{key:"isEmpty",value:function(){return this.getTextContent().length<=0}},{key:"onEditorInput",value:function(){var t=this.getContent();this.el.value=t,this.el.innerText=t,this.el.innerHTML=t,f.includes(t)&&(this.el.value="");var e=y("change"),n=y("input");this.el.dispatchEvent(e),this.el.dispatchEvent(n),this.el.closest("form").dispatchEvent(e),this.formValidatorPlugin.onFormChange()}},{key:"onToolbarButtonPressed",value:function(t){var e=this.buttonConfig.findIndex((function(e){return e.action===t.action}));document.execCommand(this.buttonConfig[e].action,!1)}},{key:"showPlaceholder",value:function(){return!!this.placeholder&&(this.placeholder.style.display="block",!0)}},{key:"hidePlaceholder",value:function(){return!!this.placeholder&&(this.placeholder.style.display="none",!0)}}])&&u(n.prototype,o),i&&u(n,i),e}(r.a);h(v,"options",{baseClass:"swag-custommized-product-html-editor",customizedProductContainer:".swag-customized-products",buttonConfig:[{action:"bold",iconClassName:"icon-editor-bold"},{action:"italic",iconClassName:"icon-editor-italic"},{action:"underline",iconClassName:"icon-editor-underline"},{action:"strikeThrough",iconClassName:"icon-editor-strikethrough"}]});var b=n("ERap");function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function E(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function S(t,e){return!e||"object"!==w(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function C(t,e){return(C=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var k,_,O,z=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),S(this,P(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&C(t,e)}(e,t),n=e,i=[{key:"isPageValid",value:function(t){var e=t.required,n=t.formValidation;return!n||!(e&&!n.valid)}},{key:"elementOuterHeight",value:function(t){var e=t.offsetHeight,n=getComputedStyle(t);return e+=parseInt(n.marginTop,10)+parseInt(n.marginBottom,10)}},{key:"isHistoryApiSupported",value:function(){return!(!window.history||!history.pushState)}}],(o=[{key:"init",value:function(){this.translations={btnPrev:a.a.getDataAttribute(this.el,"swag-customized-product-step-by-step-translation-btnprev"),btnNext:a.a.getDataAttribute(this.el,"swag-customized-product-step-by-step-translation-btnnext"),btnFinish:a.a.getDataAttribute(this.el,"swag-customized-product-step-by-step-translation-btnfinish"),required:a.a.getDataAttribute(this.el,"swag-customized-product-step-by-step-translation-required")},this.containerEl=a.a.querySelector(this.el,this.options.containerSelector),this.buyButton=a.a.querySelector(document,this.options.buyButtonSelector),this.pages=a.a.querySelectorAll(this.el,this.options.pageSelector),this.pages=this.collectPages(this.pages),this.pagesCount=this.pages.length,this.currentPage=1,this.setPageHeight(this.currentPage),this.configureElements=a.a.querySelectorAll(this.el,this.options.configureStepByStepSelector),this.pagerEl=a.a.querySelector(this.el,this.options.pagerSelector),this.pagerEl.innerHTML=this.renderPager(),this.navigationEntries=this.collectNavigationEntries(this.pages),this.navigationEl=a.a.querySelector(this.el,this.options.navigationSelector),this.navigationEl.innerHTML=this.renderNavigationSelection(),this.options.history.enabled&&(this.parseLocationHashOnAndJumpToPage(),this.updateHistory()),this._registerEvents()}},{key:"_registerEvents",value:function(){var t=this;return b.a.iterate(this.configureElements,(function(e){e.addEventListener("click",t.onClickStartButton.bind(t),!1)})),this.pagerEl.addEventListener("click",(function(e){e.preventDefault(),e.target.matches(".btn-prev")&&t.prevPage(),e.target.matches(".btn-next")&&t.nextPage()})),this.navigationEl.addEventListener("change",this.onNavigationEntry.bind(this)),!(!e.isHistoryApiSupported()||!this.options.history.enabled||(window.addEventListener("popstate",this.onPopstate.bind(this)),0))}},{key:"onNavigationEntry",value:function(t){if(t.target.matches(".swag-customized-products-navigation")){var e=parseInt(t.target.options[t.target.selectedIndex].value,10);this.transitionToPage(e+1)}}},{key:"onPopstate",value:function(){this.parseLocationHashOnAndJumpToPage()}},{key:"onClickStartButton",value:function(t){t.preventDefault(),this.transitionToPage(2)}},{key:"renderNavigationSelection",value:function(){var t,e=this;return this.navigationEl.style.display=e.currentPage<=1||e.currentPage>=e.pagesCount?"none":"block",'\n            <div class="form-group">\n                <div class="swag-customized-products-navigation">\n                    <select class="swag-customized-products-navigation" tabindex="-1">\n                       '.concat(this.navigationEntries.map((function(t){return'\n                <option value="'.concat(t.pageNum,'"').concat(e.currentPage-1===t.pageNum?' selected="selected"':"",">\n                    ").concat(t.pageNum," - ").concat(t.name," ").concat(t.required?"(".concat(e.translations.required,")"):"","\n                </option>")})),'\n                    </select>\n                    <span class="swag-customized-products-navigation__text">\n                        ').concat((t=e.navigationEntries.find((function(t){return e.currentPage-1===t.pageNum})))?"".concat(t.pageNum,". ").concat(t.name):"",'\n                    </span>\n                    <svg\n                        xmlns="http://www.w3.org/2000/svg"\n                        xmlns:xlink="http://www.w3.org/1999/xlink"\n                        width="16"\n                        height="16"\n                        viewBox="0 0 16 16"\n                        class="swag-customized-products-navigation__icon">\n                      <defs>\n                        <path\n                            id="icons-small-arrow-small-down-a"\n                            d="M5.70710678,6.29289322 C5.31658249,5.90236893 4.68341751,5.90236893 4.29289322,6.29289322 C3.90236893,6.68341751 3.90236893,7.31658249 4.29289322,7.70710678 L7.29289322,10.7071068 C7.68341751,11.0976311 8.31658249,11.0976311 8.70710678,10.7071068 L11.7071068,7.70710678 C12.0976311,7.31658249 12.0976311,6.68341751 11.7071068,6.29289322 C11.3165825,5.90236893 10.6834175,5.90236893 10.2928932,6.29289322 L8,8.58578644 L5.70710678,6.29289322 Z"/>\n                      </defs>\n                      <use\n                        fill="#758CA3"\n                        fill-rule="evenodd"\n                        transform="matrix(-1 0 0 1 16 0)"\n                        xlink:href="#icons-small-arrow-small-down-a"/>\n                    </svg>\n                </div>\n            </div>\n        ')}},{key:"renderPager",value:function(){var t=this;return'\n            <div class="swag-customized-products-pager'.concat(t.currentPage<=1||t.currentPage>=t.pagesCount?" d-none":"",'">\n                <button class="swag-customized-products-pager__button btn-prev btn btn-sm btn-outline-primary" tabindex="0"\n                        ').concat(t.currentPage<=1?' disabled="true"':"",">\n                    ").concat(this.translations.btnPrev,'\n                </button>\n\n                <span class="swag-customized-products-pager__page-number">\n                    ').concat("".concat(t.currentPage-1," / ").concat(t.pagesCount-2),'\n                </span>\n\n                <button class="swag-customized-products-pager__button btn-next btn btn-sm btn-outline-primary" tabindex="0"\n                        ').concat(t.currentPage-1>=t.pagesCount-2&&!t.isValidConfiguration()?' disabled="true"':t.currentPage>=t.pagesCount?' disabled="true"':"",">\n                    ").concat(t.currentPage-1>=t.pagesCount-2?t.translations.btnFinish:t.translations.btnNext,"\n                </button>\n            </div>\n        ")}},{key:"collectPages",value:function(t){var n=this;return Array.from(t).map((function(t,o){var i=a.a.getDataAttribute(t,"name",!1)||null,r=t.children[0],s=e.elementOuterHeight(r),l=n.collectFormControlFromPage(t,!0),u=!1;return l&&l.elements&&(u=l.elements.reduce((function(t,e){return t||(t=e.required||!!e.dataset.swagCustomizedProductsSelectionRequired)}),!1)),{pageEl:t,pageNum:o,name:i,required:u,formValidation:l,pageHeight:s}}))}},{key:"collectNavigationEntries",value:function(t){return t.reduce((function(t,e){return e.name?(t.push(e),t):t}),[])}},{key:"nextPage",value:function(){var t=this.currentPage+1;return t>=this.pagesCount&&(t=this.pagesCount),this.transitionToPage(t)}},{key:"prevPage",value:function(){var t=this.currentPage-1;return t<1&&(t=1),this.transitionToPage(t)}},{key:"resetToFirstPage",value:function(){return this.transitionToPage(1)}},{key:"transitionToPage",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.resetPreviousFormControl(this.pages[this.currentPage-1]);var n="translateX(-".concat(100*(t-1),"%)");return this.containerEl.style.transform=n,this.containerEl.style.webkitTransform=n,this.containerEl.style.msTransform=n,this.currentPage=t,this.setActiveFormElement(this.pages[this.currentPage-1]),this.pagerEl.innerHTML=this.renderPager(),this.navigationEl.innerHTML=this.renderNavigationSelection(),this.setPageHeight(t),e&&this.updateHistory(),!0}},{key:"setActiveFormElement",value:function(t){var e=t.formValidation,n=e.elements,o=e.handler;return!(!n||!o||(n.forEach((function(t){t.addEventListener("input",o,!1)})),0))}},{key:"collectFormControlFromPage",value:function(t){var e=Array.from(a.a.querySelectorAll(t,this.options.formControlSelector,!1));if(!e)return{elements:null,handler:null,valid:!0};e.forEach((function(t){t.setAttribute("tabindex",-1)}));var n=s.a.debounce(this.validateCurrentField.bind(this),this.options.validation.delay);return{elements:e,valid:e.reduce((function(t,e){return t?t=void 0!==e.dataset.swagCustomizedProductsSelectionRequired?e.checked:e.validity.valid:t}),!0),handler:n}}},{key:"resetPreviousFormControl",value:function(t){var e=t.formValidation,n=e.elements,o=e.handler;return!o||(n.forEach((function(t){t.removeEventListener("input",o)})),!0)}},{key:"validateCurrentField",value:function(){var t,e=this.pages[this.currentPage-1],n=e.formValidation.elements;t=void 0!==a.a.getDataAttribute(n[0],"swag-customized-products-selection-required",!1)?n.reduce((function(t,e){return t||e.checked}),!1):n.reduce((function(e,n){if(!e)return e;var o=n.checkValidity();if(Object.prototype.hasOwnProperty.call(n,"_flatpickr")&&(o=n._flatpickr.selectedDates.length>0),n.__plugins&&n.__plugins.size>0&&n.__plugins.has("SwagCustomizedProductsHtmlEditor")){var i=window.PluginManager.getPluginInstanceFromElement(n,"SwagCustomizedProductsHtmlEditor");t=!i.isEmpty()}return e=o}),!0),e.formValidation.valid=t,this.pagerEl.innerHTML=this.renderPager(),this.navigationEl.innerHTML=this.renderNavigationSelection()}},{key:"setPageHeight",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.pages[t-1].pageEl,i=this.pages[t-1].pageHeight,r=function(t){var e=window.getComputedStyle(t);return window.parseFloat(e.paddingTop)+window.parseFloat(e.paddingBottom)};if(n){var a=o.children;if(!a||a.length<=0)return!1;var s=a[0];i=Array.from(s.children).reduce((function(t,n){return t+e.elementOuterHeight(n)}),r(o))}return i>this.options.maxContentHeight&&(i=this.options.maxContentHeight,o.style.height="".concat(i,"px"),o.style.overflowY="scroll",o.classList.add(this.options.scrollableClass)),this.containerEl.style.height="".concat(i,"px"),!0}},{key:"parseLocationHashOnAndJumpToPage",value:function(){if(!e.isHistoryApiSupported()||!this.options.history.enabled)return!1;if(!window.location.hash||window.location.hash.length<=0)return!1;var t=window.location.hash.substring(1),n=parseInt(t.replace(this.options.history.hashPrefix,""),10);return n+=1,this.transitionToPage(n,!1),!0}},{key:"updateHistory",value:function(){return!(!e.isHistoryApiSupported()||!this.options.history.enabled||(window.history.pushState({currentPage:this.currentPage,pagesCount:this.pagesCount},"","#".concat(this.options.history.hashPrefix).concat(this.currentPage-1)),0))}},{key:"isValidConfiguration",value:function(){var t=this.pages.reduce((function(t,n){return t&&n.required?t=e.isPageValid(n):t}),!0),n=window.PluginManager.getPluginInstanceFromElement(this.el,"SwagCustomizedProductsExclusionListValidation");return n&&(t=!n.isViolation),t}}])&&E(n.prototype,o),i&&E(n,i),e}(r.a);O={containerSelector:".swag-customized-products__scrollable",pageSelector:".swag-customized-products__item",configureStepByStepSelector:'*[data-swag-customized-product-step-by-step-configure="true"]',pagerSelector:".swag-customized-products__pager-holder",navigationSelector:".swag-customized-products__navigation-holder",formControlSelector:".swag-customized-products-form-control",buyButtonSelector:"#productDetailPageBuyProductForm .btn-buy",scrollableClass:"is--scrollable",history:{enabled:!0,hashPrefix:"wizard-step-"},validation:{delay:300,disableBuyButtonOnInvalid:!0},maxContentHeight:500},(_="options")in(k=z)?Object.defineProperty(k,_,{value:O,enumerable:!0,configurable:!0,writable:!0}):k[_]=O;var T=n("F4Z+"),x=n("p4AR");function F(t){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function j(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function L(t,e){return!e||"object"!==F(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function I(t){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function B(t,e){return(B=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var A=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),L(this,I(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&B(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this.fileUpload=this.el,!1!==this._prepareUploadedFilesList()&&(this.stepByStepElement=a.a.querySelector(document,'*[data-swag-customized-product-step-by-step="true"]',!1),this.dropzone=a.a.querySelector(this.fileUpload,this.options.selectors.dropzonePrefix+this.options.optionId),this.input=a.a.querySelector(this.dropzone,this.options.selectors.inputPrefix+this.options.optionId),this.browseButton=a.a.querySelector(this.dropzone,this.options.selectors.browseButtonPrefix+this.options.optionId),this.buyForm=a.a.querySelector(document,this.options.selectors.buyForm),this.iconSuccess=a.a.querySelector(this.fileUpload,this.options.selectors.iconSuccess).innerHTML,this.iconError=a.a.querySelector(this.fileUpload,this.options.selectors.iconError).innerHTML,this.httpClient=new x.a,this.registry=new Map,this._registerEventListeners())}},{key:"_prepareUploadedFilesList",value:function(){this.uploadedFilesList=a.a.querySelector(this.fileUpload,this.options.selectors.uploadedFilesList);var t=a.a.querySelector(this.uploadedFilesList,this.options.selectors.fileTemplate);return this.fileTemplate=t.cloneNode(!0),this.uploadedFilesList.hasChildNodes()&&this.uploadedFilesList.removeChild(t),null!==this.fileTemplate}},{key:"_registerEventListeners",value:function(){this.input.addEventListener("change",this._onFileInputChanged.bind(this)),this.browseButton.addEventListener("click",this._onBrowse.bind(this)),this.dropzone.addEventListener("drop",this._onDropOnDropzone.bind(this)),document.addEventListener("dragenter",this._onDragEnter.bind(this),!1),document.addEventListener("dragleave",this._onDragLeave.bind(this),!1),document.addEventListener("dragover",this._onDragOver,!1),document.addEventListener("drop",this._onDropOnDocument.bind(this),!1)}},{key:"_onDragEnter",value:function(t){t.preventDefault();var e=t.target,n=this.options.selectors.dropzoneIdPrefix+this.options.optionId;return!!e.closest(n)&&(this.dropzone.classList.add(this.options.classes.dragover),this.browseButton.setAttribute("disabled","disabled"),!0)}},{key:"_onDragLeave",value:function(t){var e=t.target,n=this.options.selectors.dropzoneIdPrefix+this.options.optionId;return!e.closest(n)&&(this.dropzone.classList.remove("dragover"),this.browseButton.removeAttribute("disabled"),!0)}},{key:"_onDragOver",value:function(t){t.preventDefault()}},{key:"_onDropOnDocument",value:function(t){t.preventDefault(),this.dropzone.classList.remove(this.options.classes.dragover),this.browseButton.removeAttribute("disabled")}},{key:"_onBrowse",value:function(t){t.preventDefault(),this.input.click()}},{key:"_onDropOnDropzone",value:function(t){this._onFilesAdded(t.dataTransfer.files)}},{key:"_onFileInputChanged",value:function(t){this._onFilesAdded(t.target.files)}},{key:"_onFilesAdded",value:function(t){Array.from(t).forEach(this._handleFileUpload.bind(this)),this.input.value=""}},{key:"setPageHeightInStepByStep",value:function(){if(!this.stepByStepElement)return!1;var t=window.PluginManager.getPluginInstanceFromElement(this.stepByStepElement,"SwagCustomizedProductsStepByStepWizard");return t.setPageHeight(t.currentPage,!0),!0}},{key:"_handleFileUpload",value:function(t){if(this.registry.has(t.name))return!1;var e=Array.from(this.registry.values()).filter((function(t){return t.valid})).length>=this.options.maxCount;if(this.registry.set(t.name,{file:t,element:this._appendNewFileElement(t.name),valid:!e}),e)return this._onUploadError(t.name),!1;var n=new FileReader;return n.addEventListener("error",this._onUploadError.bind(this,t.name)),n.addEventListener("load",this._sendUploadRequest.bind(this,t)),n.readAsArrayBuffer(t),!0}},{key:"_appendNewFileElement",value:function(t){var e=document.createElement("div");return e.setAttribute("class",this.fileTemplate.getAttribute("class")),e.innerHTML=this.fileTemplate.innerHTML,a.a.querySelector(e,this.options.selectors.filename).innerHTML=t,this.uploadedFilesList.appendChild(e),this.setPageHeightInStepByStep(),e}},{key:"_sendUploadRequest",value:function(t){var e=new FormData;e.append("file",t,t.name),e.append("optionId",this.options.optionId),e.append("_csrf_token",this.options.csrfToken),this.httpClient.post(this.options.endpoint,e,this._uploadRequestCallback.bind(this,t.name),"multipart/form-data")}},{key:"_uploadRequestCallback",value:function(t,e){try{e=JSON.parse(e)}catch(e){return this._onUploadError(t),!1}return void 0!==e.errors?(this._onUploadError(t),!1):(this._onUploadSuccess(t,e),!0)}},{key:"_onUploadSuccess",value:function(t,e){var n=this.registry.get(t),o=a.a.querySelector(n.element,this.options.selectors.iconElement);n.element.classList.add(this.options.classes.success),o.innerHTML=this.iconSuccess;var i=this._createMediaIdInput(t,e.mediaId),r=this._createFileNameInput(t);this.buyForm.appendChild(i),this.buyForm.appendChild(r),this.updatePriceDisplay(),a.a.querySelector(n.element,this.options.selectors.closeButton).addEventListener("click",this._onRemoveValidElement.bind(this,n,i,r))}},{key:"_onUploadError",value:function(t){var e=this.registry.get(t),n=a.a.querySelector(e.element,this.options.selectors.iconElement);e.element.classList.add(this.options.classes.error),n.innerHTML=this.iconError,a.a.querySelector(e.element,this.options.selectors.closeButton).addEventListener("click",this._onRemoveInvalidElement.bind(this,e))}},{key:"_onRemoveValidElement",value:function(t,e,n,o){this._removeElement(t,o),e.remove(),n.remove(),this.updatePriceDisplay(),this.triggerExclusionValidation()}},{key:"_onRemoveInvalidElement",value:function(t,e){this._removeElement(t,e),this.triggerExclusionValidation()}},{key:"_removeElement",value:function(t,e){e.preventDefault(),this.uploadedFilesList.removeChild(t.element),this.registry.delete(t.file.name);var n=a.a.querySelector(this.buyForm,this.options.selectors.customizedProductContainer,!1);n&&window.PluginManager.getPluginInstanceFromElement(n,"SwagCustomizedProductsFormValidator").onFormChange(),this.setPageHeightInStepByStep()}},{key:"_createMediaIdInput",value:function(t,e){var n=document.createElement("input");return n.type="hidden",n.name="customized-products-template[options][".concat(this.options.optionId,"][media][").concat(t,"][id]"),n.value=e,n}},{key:"_createFileNameInput",value:function(t){var e=document.createElement("input");return e.type="hidden",e.name="customized-products-template[options][".concat(this.options.optionId,"][media][").concat(t,"][filename]"),e.value=t,e}},{key:"updatePriceDisplay",value:function(){var t=a.a.querySelector(document,this.options.selectors.priceDisplayContainer,!1);return!!t&&(window.PluginManager.getPluginInstanceFromElement(t,"SwagCustomizedProductPriceDisplay").onFormChange(),!0)}},{key:"triggerExclusionValidation",value:function(){var t=a.a.querySelector(document,this.options.selectors.customizedProductContainer,!1);if(!t)return!1;var e=window.PluginManager.getPluginInstanceFromElement(t,"SwagCustomizedProductsExclusionListValidation");return!!e&&(e.onInputChange(),!0)}}])&&j(n.prototype,o),i&&j(n,i),e}(r.a);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(A,"options",{endpoint:"",optionId:"",maxCount:1,csrfToken:"",selectors:{dropzonePrefix:"#customized-products-dropzone-",inputPrefix:"#customized-products-dropzone-input-",browseButtonPrefix:"#customized-products-browse-",dropzoneIdPrefix:"#customized-products-dropzone-",upload:".customized-products-upload",buyForm:"#productDetailPageBuyProductForm",dropzone:".customized-products-upload-dropzone",uploadedFilesList:".customized-products-upload-files",fileTemplate:".customized-products-upload-files-element",filename:".customized-products-upload-files-element-filename",iconElement:".customized-products-upload-files-element-icon",closeButton:".customized-products-upload-files-element-close-button",priceDisplayContainer:'[data-swag-customized-product-price-display="true"]',customizedProductContainer:".swag-customized-products",iconSuccess:".customized-products-upload-icon-success",iconError:".customized-products-upload-icon-error"},classes:{dragover:"dragover",success:"is--success",error:"is--error"}});var q=n("u0Tz");function H(t){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function M(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function D(t,e){return!e||"object"!==H(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function V(t){return(V=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function U(t,e){return(U=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var N=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),D(this,V(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&U(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this.client=new x.a,this.priceDisplayHolder=a.a.querySelector(document,".swag-customized-product__price-display-holder"),this.buyForm=this.el.parentNode,this.buyButton=a.a.querySelector(this.buyForm,this.options.buyButtonSelector),this.onFormChange(),this.buyForm.addEventListener("change",this.onFormChange.bind(this))}},{key:"onFormChange",value:function(){var t=new FormData(this.buyForm);t.set("_csrf_token",this.options.csrfToken),q.a.create(this.priceDisplayHolder),this.client.post(this.options.url,t,this.onTemplateReceived.bind(this))}},{key:"onTemplateReceived",value:function(t){q.a.remove(this.priceDisplayHolder),this.priceDisplayHolder.innerHTML=t}}])&&M(n.prototype,o),i&&M(n,i),e}(r.a);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(N,"options",{formControlSelector:".swag-customized-products-form-control",buyButtonSelector:"#productDetailPageBuyProductForm .btn-buy",idPrefix:"swag-customized-products-option-id-",csrfToken:"",url:""});var R=n("KeF5");function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function W(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function X(t,e){return!e||"object"!==J(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function $(t){return($=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Z(t,e){return(Z=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var K=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),X(this,$(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Z(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this.template=a.a.querySelector(this.el,this.options.templateSelector),this.imageEl=a.a.querySelector(this.el,this.options.imageSelector),this.contentEl=null,this.closeButtonEl=null,this.prepareModalContent(),this.registerEvents()}},{key:"registerEvents",value:function(){this.el.addEventListener("click",this.onImageClicked.bind(this))}},{key:"prepareModalContent",value:function(){var t=a.a.getAttribute(this.imageEl,"src"),e=a.a.getAttribute(this.imageEl,"alt"),n=this.template,o=a.a.querySelector(n,this.options.template.imageSelector),i=a.a.querySelector(n,this.options.template.captionSelector);return o.setAttribute("src",t),o.setAttribute("alt",e),i.innerText=e,this.$emitter.publish("prepareModalContent",{content:n,imageCaption:e,imageSrc:t}),!0}},{key:"onImageClicked",value:function(t){t.preventDefault(),this.$emitter.publish("onImageClicked",{event:t}),this.spawnZoomModal()}},{key:"onCloseClicked",value:function(t){t.preventDefault(),this.$emitter.publish("onCloseClicked",{event:t}),R.c.remove(),document.body.removeChild(this.contentEl)}},{key:"spawnZoomModal",value:function(){var t=this;return this.contentEl=this.template.firstElementChild.cloneNode(!0),this.closeButtonEl=a.a.querySelector(this.contentEl,this.options.template.closeButtonSelector),this.closeButtonEl.addEventListener("click",this.onCloseClicked.bind(this),{once:!0}),R.c.create((function(){document.body.appendChild(t.contentEl)})),this.$emitter.publish("spawnZoomModal",{contentEl:this.contentEl}),!0}}])&&W(n.prototype,o),i&&W(n,i),e}(r.a);function G(t){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Q(t,e){return!e||"object"!==G(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function tt(t){return(tt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(K,"options",{imageSelector:".swag-customized-products-option__image",templateSelector:".swag-customized-products-image-zoom__template",template:{imageSelector:".swag-customized-products-image-zoom__image",captionSelector:".swag-customized-products-image-zoom__caption",closeButtonSelector:".swag-customized-products-image-zoom__icon-close"}});var nt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Q(this,tt(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this.shareButton=this.el,this.buyForm=this.el.closest("form"),this.iconPaperclip=a.a.querySelector(this.buyForm,".swag-customized-products-share-icons .icon-paperclip"),this.client=new x.a,this.registerEvents()}},{key:"registerEvents",value:function(){this.shareButton.addEventListener("click",this.onShareButtonClicked.bind(this))}},{key:"onShareButtonClicked",value:function(t){t.preventDefault();var e=new FormData(this.buyForm);e.set("_csrf_token",this.options.csrfToken),e.set("absoluteBaseUrl",this.options.absoluteBaseUrl),e.set("baseUrl",this.options.baseUrl),q.a.create(this.el.closest(".card")),this.client.post(this.options.url,e,this.onConfigurationReceived.bind(this))}},{key:"onConfigurationReceived",value:function(t){var e=JSON.parse(t).shareUrl,n=this.el.parentNode,o=document.createElement("div");o.classList.add("input-group");var i=document.createElement("input");i.setAttribute("readonly",!0),i.classList.add("form-control"),i.setAttribute("value",e),o.appendChild(i);var r=document.createElement("div");r.classList.add("input-group-append");var a=document.createElement("button");a.appendChild(this.iconPaperclip.cloneNode(!0)),["btn","btn-sm"].forEach((function(t){a.classList.add(t)})),a.addEventListener("click",(function(t){t.preventDefault();try{i.select(),i.setSelectionRange(0,-1),document.execCommand("copy")}catch(t){i.classList.add("is-invalid")}i.classList.add("is-valid")})),r.appendChild(a),o.appendChild(r),Array.from(n.children).forEach((function(t){n.removeChild(t)})),n.appendChild(o),q.a.remove(n.closest(".card"))}}])&&Y(n.prototype,o),i&&Y(n,i),e}(r.a);function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function it(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function rt(t,e){return!e||"object"!==ot(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function at(t){return(at=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function st(t,e){return(st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(nt,"options",{url:"",csrfToken:"",absoluteBaseUrl:"",baseUrl:""});var lt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),rt(this,at(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this.buyForm=this.el.closest("form"),this.options.oldHash&&this.options.oldHash.length>0&&this.options.configuration.quantity&&this.restoreQuantity(),this.restoreUploadValues()}},{key:"restoreQuantity",value:function(){a.a.querySelector(this.buyForm,".product-detail-quantity-select").value=this.options.configuration.quantity}},{key:"restoreUploadValues",value:function(){var t=this,e=[this.options.imageUploadType,this.options.fileUploadType];Object.keys(this.options.configuration).forEach((function(n){var o=t.options.configuration[n];o.type&&e.includes(o.type)&&t.restoreFiles(n,o.value)}))}},{key:"restoreFiles",value:function(t,e){var n=a.a.querySelector(this.buyForm,"".concat(this.options.selectors.dropZone).concat(t),!1);if(!n)return!1;var o=window.PluginManager.getPluginInstanceFromElement(n.parentNode,"SwagCustomizedProductsFileUpload");return e.forEach((function(t){var e=t.filename,n=new File([],e);o.registry.set(e,{file:n,element:o._appendNewFileElement(e),valid:!0}),o._onUploadSuccess(e,{mediaId:t.mediaId})})),!0}}])&&it(n.prototype,o),i&&it(n,i),e}(r.a);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(lt,"options",{configuration:[],oldHash:"",imageUploadType:"",fileUploadType:"",selectors:{dropZone:"#customized-products-dropzone-"}}),window.PluginManager.register("SwagCustomizedProductsFileUpload",A,"[data-swag-customized-products-file-upload]"),window.PluginManager.register("SwagCustomizedProductsCollapsingValidOptions",o.a,'*[data-swag-customized-products-collapse="true"]'),window.PluginManager.register("SwagCustomizedProductsFormValidator",i.a,'[data-swag-customized-products-form-validator="true"]'),window.PluginManager.register("SwagCustomizedProductPriceDisplay",N,'[data-swag-customized-product-price-display="true"]'),window.PluginManager.register("SwagCustomizedProductsHtmlEditor",v,"[data-swag-customized-products-html-editor]"),window.PluginManager.register("SwagCustomizedProductsStepByStepWizard",z,'*[data-swag-customized-product-step-by-step="true"]'),window.PluginManager.register("SwagCustomizedProductsExclusionListValidation",T.a,'*[data-swag-exclusion-list-validation="true"]'),window.PluginManager.register("SwagCustomizedProductsImageZoom",K,'*[data-swag-customized-products-image-zoom="true"]'),window.PluginManager.register("SwagCustomizedProductsConfigurationShare",nt,'*[data-swag-customized-products-configuration-share="true"]'),window.PluginManager.register("SwagCustomizedProductsRestoreConfiguration",lt,'*[data-swag-customized-products-restore-configuration="true"]')},UuB4:function(t,e,n){"use strict";n.r(e),e.default={type:["colorselect","imageselect","select"],validate:function(t){var e=t.element,n=t.operator;return"select"===e.tagName.toLowerCase()?"X"===n?e.value.length>0:!e.value.length:"X"===n?!e.checked:e.checked}}},aUfU:function(t,e,n){"use strict";n.r(e),e.default={type:["imageupload","fileupload"],validate:function(t){var e=t.element,n=t.operator,o=window.PluginManager.getPluginInstanceFromElement(e.closest(".customized-products-upload"),"SwagCustomizedProductsFileUpload");return"X"===n?o.registry.size>0:!o.registry.size}}},bEUM:function(t,e,n){"use strict";n.r(e),e.default={type:["checkbox"],validate:function(t){var e=t.element;return"X"===t.operator?e.checked:!e.checked}}},eg0c:function(t,e,n){"use strict";e.a=function(t){var e={},o=function(){var t=n("Kpce");return t.keys().reduce((function(e,n){var o=t(n).default;return o.type.forEach((function(t){e[t]=o})),e}),{})},i=function(t){return Object.keys(e).includes(t)};return{name:"option-type-handler-manager",handlers:e=o(),clear:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e={},t&&(e=o()),!0},has:i,get:function(t){return i(t)?e[t]:null},add:function(t,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return!(!o&&i(t))&&(e[t]=n,!0)},remove:function(t){return!!i(t)&&(delete e[t],!0)},call:function(n,o){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"validate",r=arguments.length,a=new Array(r>3?r-3:0),s=3;s<r;s++)a[s-3]=arguments[s];var l=e[o][i].apply(n,a);return t.publish("swagCustomizedProducts/optionType/".concat(i,"/").concat(o),{params:a}),l}}}},lxcy:function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return h}));var o=n("FGIj"),i=n("gHbT");function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function s(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c,p,d,h=function(e){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),s(this,l(n).apply(this,arguments))}var o,r,c;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(n,e),o=n,(r=[{key:"init",value:function(){var t=this;this.configurator=this.el,this.optionElements=i.a.querySelectorAll(this.configurator,this.options.collapsingElementsSelector),this.currentClickPromise=null,i.a.querySelectorAll(this.configurator,this.options.inputFieldsSelector).forEach((function(e){e.addEventListener("focus",t.onInputBlur.bind(t)),e.addEventListener("blur",t.onInputClick.bind(t))}))}},{key:"onInputBlur",value:function(t){var e=this;null!==this.currentClickPromise&&this.currentClickPromise.then((function(){e.collapseValid(t)}))}},{key:"onInputClick",value:function(t){this.updateLastEventOption(t)}},{key:"collapseValid",value:function(e){var n=this,o=e.target.closest(this.options.collapsingElementsSelector);this.lastEventOption!==o&&this.optionElements.forEach((function(e){var o=i.a.querySelectorAll(e,n.options.inputFieldsSelector);Array.from(o).some((function(t){return t.validity.valid}))&&e===n.lastEventOption&&t(e).collapse("hide")}))}},{key:"updateLastEventOption",value:function(t){var e=this;this.currentClickPromise=new Promise((function(n){e.lastEventOption=t.target.closest(e.options.collapsingElementsSelector),n()}))}}])&&a(o.prototype,r),c&&a(o,c),n}(o.a);d={collapsingElementsSelector:".collapsingCustomizedProductsOption",inputFieldsSelector:"input, textarea"},(p="options")in(c=h)?Object.defineProperty(c,p,{value:d,enumerable:!0,configurable:!0,writable:!0}):c[p]=d}).call(this,n("UoTJ"))}},[["RVSf","runtime","vendor-node","vendor-shared"]]]);